{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * NextCloud Desktop Client - Tsyne Port\n *\n * @tsyne-app:name NextCloud\n * @tsyne-app:icon confirm\n * @tsyne-app:category Network\n * @tsyne-app:args (a: App) => void\n *\n * A cloud storage and file sync client ported from NextCloud iOS to Tsyne:\n * - File browser with folder navigation\n * - Upload and download management\n * - Account connection and authentication\n * - File sharing capabilities\n * - Sync status tracking\n * - Recent files and folders\n *\n * Portions copyright NextCloud Inc and portions copyright Paul Hammant 2025\n */\n\n// ============================================================================\n// DATA MODELS\n// ============================================================================\n\nexport interface CloudFile {\n  id: string;\n  name: string;\n  path: string;\n  isFolder: boolean;\n  size: number;\n  modified: Date;\n  shared: boolean;\n  owner: string;\n}\n\nexport interface Account {\n  id: string;\n  username: string;\n  server: string;\n  email: string;\n  isConnected: boolean;\n  lastSync: Date;\n  syncEnabled: boolean;\n}\n\nexport interface SyncItem {\n  id: string;\n  fileName: string;\n  action: 'upload' | 'download' | 'sync';\n  status: 'pending' | 'in-progress' | 'completed' | 'error';\n  progress: number;\n}\n\n// ============================================================================\n// NEXTCLOUD STORE (Observable)\n// ============================================================================\n\ntype ChangeListener = () => void;\n\nexport class NextCloudStore {\n  private account: Account = {\n    id: 'acc-001',\n    username: 'john.doe',\n    server: 'https://cloud.example.com',\n    email: 'john@example.com',\n    isConnected: true,\n    lastSync: new Date(Date.now() - 300000),\n    syncEnabled: true,\n  };\n\n  private files: CloudFile[] = [\n    {\n      id: 'file-001',\n      name: 'Documents',\n      path: '/',\n      isFolder: true,\n      size: 0,\n      modified: new Date(Date.now() - 604800000),\n      shared: false,\n      owner: 'john.doe',\n    },\n    {\n      id: 'file-002',\n      name: 'Photos',\n      path: '/',\n      isFolder: true,\n      size: 0,\n      modified: new Date(Date.now() - 86400000),\n      shared: false,\n      owner: 'john.doe',\n    },\n    {\n      id: 'file-003',\n      name: 'Project Report.pdf',\n      path: '/Documents',\n      isFolder: false,\n      size: 2048000,\n      modified: new Date(Date.now() - 172800000),\n      shared: true,\n      owner: 'john.doe',\n    },\n    {\n      id: 'file-004',\n      name: 'Budget 2025.xlsx',\n      path: '/Documents',\n      isFolder: false,\n      size: 512000,\n      modified: new Date(Date.now() - 345600000),\n      shared: false,\n      owner: 'john.doe',\n    },\n    {\n      id: 'file-005',\n      name: 'Vacation 2024.jpg',\n      path: '/Photos',\n      isFolder: false,\n      size: 4096000,\n      modified: new Date(Date.now() - 432000000),\n      shared: true,\n      owner: 'john.doe',\n    },\n  ];\n\n  private syncItems: SyncItem[] = [\n    {\n      id: 'sync-001',\n      fileName: 'Presentation.pptx',\n      action: 'upload',\n      status: 'completed',\n      progress: 100,\n    },\n    {\n      id: 'sync-002',\n      fileName: 'Archive.zip',\n      action: 'download',\n      status: 'in-progress',\n      progress: 65,\n    },\n  ];\n\n  private nextSyncId = 3;\n  private changeListeners: ChangeListener[] = [];\n  private currentPath: string = '/';\n\n  subscribe(listener: ChangeListener): () => void {\n    this.changeListeners.push(listener);\n    return () => {\n      this.changeListeners = this.changeListeners.filter((l) => l !== listener);\n    };\n  }\n\n  private notifyChange() {\n    this.changeListeners.forEach((listener) => listener());\n  }\n\n  // ========== Account ==========\n  getAccount(): Account {\n    return { ...this.account };\n  }\n\n  connectAccount(server: string, username: string, password: string): boolean {\n    // Simulate connection\n    this.account.isConnected = true;\n    this.account.server = server;\n    this.account.username = username;\n    this.account.lastSync = new Date();\n    this.notifyChange();\n    return true;\n  }\n\n  disconnectAccount() {\n    this.account.isConnected = false;\n    this.notifyChange();\n  }\n\n  toggleSync(enabled: boolean) {\n    this.account.syncEnabled = enabled;\n    this.notifyChange();\n  }\n\n  // ========== Files ==========\n  getFiles(path: string = '/'): CloudFile[] {\n    return this.files.filter((f) => f.path === path).sort((a, b) => {\n      if (a.isFolder !== b.isFolder) return b.isFolder ? 1 : -1;\n      return a.name.localeCompare(b.name);\n    });\n  }\n\n  getAllFiles(): CloudFile[] {\n    return [...this.files];\n  }\n\n  getRecentFiles(limit: number = 10): CloudFile[] {\n    return [...this.files]\n      .filter((f) => !f.isFolder)\n      .sort((a, b) => b.modified.getTime() - a.modified.getTime())\n      .slice(0, limit);\n  }\n\n  getSharedFiles(): CloudFile[] {\n    return this.files.filter((f) => f.shared && !f.isFolder);\n  }\n\n  searchFiles(query: string): CloudFile[] {\n    const lowerQuery = query.toLowerCase();\n    return this.files.filter((f) =>\n      f.name.toLowerCase().includes(lowerQuery)\n    );\n  }\n\n  deleteFile(fileId: string) {\n    this.files = this.files.filter((f) => f.id !== fileId);\n    this.notifyChange();\n  }\n\n  shareFile(fileId: string): boolean {\n    const file = this.files.find((f) => f.id === fileId);\n    if (file) {\n      file.shared = !file.shared;\n      this.notifyChange();\n      return true;\n    }\n    return false;\n  }\n\n  createFolder(path: string, folderName: string): CloudFile {\n    const newFolder: CloudFile = {\n      id: `folder-${Date.now()}`,\n      name: folderName,\n      path,\n      isFolder: true,\n      size: 0,\n      modified: new Date(),\n      shared: false,\n      owner: this.account.username,\n    };\n    this.files.push(newFolder);\n    this.notifyChange();\n    return newFolder;\n  }\n\n  // ========== Sync ==========\n  getSyncItems(): SyncItem[] {\n    return [...this.syncItems];\n  }\n\n  getActiveSyncItems(): SyncItem[] {\n    return this.syncItems.filter((s) => s.status === 'in-progress' || s.status === 'pending');\n  }\n\n  addSyncItem(fileName: string, action: 'upload' | 'download' | 'sync'): SyncItem {\n    const item: SyncItem = {\n      id: `sync-${String(this.nextSyncId++).padStart(3, '0')}`,\n      fileName,\n      action,\n      status: 'pending',\n      progress: 0,\n    };\n    this.syncItems.unshift(item);\n    this.notifyChange();\n    return item;\n  }\n\n  updateSyncProgress(syncId: string, progress: number) {\n    const item = this.syncItems.find((s) => s.id === syncId);\n    if (item) {\n      item.progress = progress;\n      if (progress === 100) {\n        item.status = 'completed';\n      } else if (progress > 0) {\n        item.status = 'in-progress';\n      }\n      this.notifyChange();\n    }\n  }\n\n  // ========== Analytics ==========\n  getTotalFileCount(): number {\n    return this.files.filter((f) => !f.isFolder).length;\n  }\n\n  getTotalFolderCount(): number {\n    return this.files.filter((f) => f.isFolder).length;\n  }\n\n  getTotalStorageUsed(): number {\n    return this.files.reduce((sum, f) => sum + f.size, 0);\n  }\n\n  getStoragePercentage(): number {\n    const total = 5 * 1024 * 1024 * 1024; // 5GB\n    return Math.round((this.getTotalStorageUsed() / total) * 100);\n  }\n\n  formatBytes(bytes: number): string {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n  }\n}\n\n// ============================================================================\n// VIEW BUILDER\n// ============================================================================\n\nexport function buildNextCloudApp(a: any): void {\n  const store = new NextCloudStore();\n  let selectedTab: 'files' | 'sync' | 'shared' | 'account' = 'files';\n  let currentPath: string = '/';\n\n  let accountStatusLabel: any;\n  let storageLabel: any;\n  let fileCountLabel: any;\n  let syncProgressLabel: any;\n  let viewStack: any;\n\n  async function updateStatusLabels() {\n    if (accountStatusLabel) {\n      const account = store.getAccount();\n      const status = account.isConnected ? 'ðŸŸ¢ Connected' : 'ðŸ”´ Disconnected';\n      await accountStatusLabel.setText(\n        `${status} â€¢ ${account.username} â€¢ ${account.server}`\n      );\n    }\n\n    if (storageLabel) {\n      const used = store.getTotalStorageUsed();\n      const percentage = store.getStoragePercentage();\n      await storageLabel.setText(\n        `Storage: ${store.formatBytes(used)} (${percentage}% of 5GB)`\n      );\n    }\n\n    if (fileCountLabel) {\n      const files = store.getTotalFileCount();\n      const folders = store.getTotalFolderCount();\n      await fileCountLabel.setText(`ðŸ“ ${folders} folders | ðŸ“„ ${files} files`);\n    }\n\n    if (syncProgressLabel) {\n      const activeSyncs = store.getActiveSyncItems();\n      if (activeSyncs.length > 0) {\n        const totalProgress = activeSyncs.reduce((sum, s) => sum + s.progress, 0) / activeSyncs.length;\n        await syncProgressLabel.setText(`Syncing: ${Math.round(totalProgress)}%`);\n      } else {\n        await syncProgressLabel.setText('Sync: Up to date');\n      }\n    }\n  }\n\n  a.window({ title: 'NextCloud Desktop Client', width: 1100, height: 800 }, (win: any) => {\n    win.setContent(() => {\n      a.vbox(() => {\n        // Header\n        a.hbox(() => {\n          a.label('â˜ï¸ NextCloud').withId('app-title');\n          a.spacer();\n          accountStatusLabel = a.label('ðŸ”´ Disconnected').withId('account-status');\n        });\n\n        a.separator();\n\n        // Tab Navigation\n        a.hbox(() => {\n          a.button('ðŸ“ Files')\n            .withId('tab-files')\n            .onClick(async () => {\n              selectedTab = 'files';\n              currentPath = '/';\n              await viewStack.refresh();\n            });\n\n          a.button('ðŸ”„ Sync')\n            .withId('tab-sync')\n            .onClick(async () => {\n              selectedTab = 'sync';\n              await viewStack.refresh();\n            });\n\n          a.button('ðŸ”— Shared')\n            .withId('tab-shared')\n            .onClick(async () => {\n              selectedTab = 'shared';\n              await viewStack.refresh();\n            });\n\n          a.button('âš™ï¸ Account')\n            .withId('tab-account')\n            .onClick(async () => {\n              selectedTab = 'account';\n              await viewStack.refresh();\n            });\n        });\n\n        a.separator();\n\n        // Status Labels\n        a.hbox(() => {\n          a.vbox(() => {\n            storageLabel = a.label('Storage: 0 B (0%)').withId('storage-label');\n            fileCountLabel = a.label('ðŸ“ 0 folders | ðŸ“„ 0 files').withId('file-count');\n            syncProgressLabel = a.label('Sync: Up to date').withId('sync-progress');\n          });\n        });\n\n        a.separator();\n\n        // Content Area\n        viewStack = a.vbox(() => {\n          // Files Tab\n          a.vbox(() => {\n            a.label('Files').withId('files-title');\n\n            a.hbox(() => {\n              a.button('ðŸ“¤ Upload')\n                .withId('btn-upload')\n                .onClick(async () => {\n                  const file = await win.showFileOpen();\n                  if (file) {\n                    store.addSyncItem('document.pdf', 'upload');\n                  }\n                });\n\n              a.button('âž• New Folder')\n                .withId('btn-new-folder')\n                .onClick(async () => {\n                  const result = await win.showEntryDialog('New Folder', 'Folder name:');\n                  if (result) {\n                    store.createFolder(currentPath, result);\n                  }\n                });\n\n              a.button('ðŸ” Search')\n                .withId('btn-search')\n                .onClick(async () => {\n                  const query = await win.showEntryDialog('Search', 'Search files:');\n                  if (query) {\n                    const results = store.searchFiles(query);\n                    await win.showInfo('Search Results', `Found ${results.length} items`);\n                  }\n                });\n            });\n\n            a.separator();\n\n            // File List\n            a.vbox(() => {\n              // Empty state\n            })\n              .bindTo({\n                items: () => store.getFiles(currentPath),\n                empty: () => {\n                  a.label('No files in this folder');\n                },\n                render: (file: CloudFile) => {\n                  const icon = file.isFolder ? 'ðŸ“' : 'ðŸ“„';\n                  const sharedIcon = file.shared ? ' ðŸ”—' : '';\n                  const size = file.isFolder ? '' : ` (${store.formatBytes(file.size)})`;\n\n                  a.hbox(() => {\n                    a.label(`${icon} ${file.name}${sharedIcon}${size}`).withId(\n                      `file-${file.id}`\n                    );\n                    a.spacer();\n                    a.label(file.modified.toLocaleDateString()).withId(\n                      `file-date-${file.id}`\n                    );\n\n                    if (!file.isFolder) {\n                      a.button('ðŸ”—')\n                        .withId(`btn-share-${file.id}`)\n                        .onClick(() => store.shareFile(file.id));\n                      a.button('ðŸ—‘ï¸')\n                        .withId(`btn-delete-${file.id}`)\n                        .onClick(() => store.deleteFile(file.id));\n                    }\n                  });\n                },\n                trackBy: (file: CloudFile) => file.id,\n              });\n          }).when(() => selectedTab === 'files');\n\n          // Sync Tab\n          a.vbox(() => {\n            a.label('Sync Status').withId('sync-title');\n\n            a.hbox(() => {\n              a.button('â¬†ï¸ Upload File')\n                .withId('btn-upload-sync')\n                .onClick(() => {\n                  store.addSyncItem('presentation.pptx', 'upload');\n                });\n\n              a.button('â¬‡ï¸ Download File')\n                .withId('btn-download-sync')\n                .onClick(() => {\n                  store.addSyncItem('archive.zip', 'download');\n                });\n\n              a.spacer();\n\n              a.button('ðŸ”„ Sync Now')\n                .withId('btn-sync-now')\n                .onClick(async () => {\n                  store.addSyncItem('sync-all', 'sync');\n                });\n            });\n\n            a.separator();\n\n            // Sync List\n            a.vbox(() => {\n              // Empty state\n            })\n              .bindTo({\n                items: () => store.getSyncItems(),\n                empty: () => {\n                  a.label('No sync items');\n                },\n                render: (item: SyncItem) => {\n                  const statusIcon = {\n                    pending: 'â³',\n                    'in-progress': 'âš™ï¸',\n                    completed: 'âœ…',\n                    error: 'âŒ',\n                  }[item.status];\n\n                  const progressBar =\n                    'â–ˆ'.repeat(Math.floor(item.progress / 10)) +\n                    'â–‘'.repeat(10 - Math.floor(item.progress / 10));\n\n                  a.hbox(() => {\n                    a.vbox(() => {\n                      a.label(`${statusIcon} ${item.action.toUpperCase()}: ${item.fileName}`).withId(\n                        `sync-${item.id}`\n                      );\n                      a.label(`${progressBar} ${item.progress}%`).withId(\n                        `sync-progress-${item.id}`\n                      );\n                    });\n                  });\n                },\n                trackBy: (item: SyncItem) => item.id,\n              });\n          }).when(() => selectedTab === 'sync');\n\n          // Shared Tab\n          a.vbox(() => {\n            a.label('Shared Files').withId('shared-title');\n\n            a.hbox(() => {\n              a.button('ðŸ”„ Refresh')\n                .withId('btn-refresh-shared')\n                .onClick(async () => {\n                  await viewStack.refresh();\n                });\n            });\n\n            a.separator();\n\n            a.vbox(() => {\n              // Empty state\n            })\n              .bindTo({\n                items: () => store.getSharedFiles(),\n                empty: () => {\n                  a.label('No shared files');\n                },\n                render: (file: CloudFile) => {\n                  a.hbox(() => {\n                    a.label(`ðŸ“„ ${file.name}`).withId(`shared-${file.id}`);\n                    a.spacer();\n                    a.label(`${store.formatBytes(file.size)}`).withId(\n                      `shared-size-${file.id}`\n                    );\n                    a.button('ðŸ—‘ï¸')\n                      .withId(`btn-unshare-${file.id}`)\n                      .onClick(() => store.shareFile(file.id));\n                  });\n                },\n                trackBy: (file: CloudFile) => file.id,\n              });\n          }).when(() => selectedTab === 'shared');\n\n          // Account Tab\n          a.vbox(() => {\n            a.label('Account Settings').withId('account-title');\n\n            a.separator();\n\n            let accountInfo: any;\n            const account = store.getAccount();\n\n            a.vbox(() => {\n              a.label(`Username: ${account.username}`).withId('account-username');\n              a.label(`Email: ${account.email}`).withId('account-email');\n              a.label(`Server: ${account.server}`).withId('account-server');\n              a.label(`Last Sync: ${account.lastSync.toLocaleString()}`).withId(\n                'account-lastsync'\n              );\n\n              a.separator();\n\n              a.hbox(() => {\n                a.label('Auto-sync enabled:');\n                a.label(account.syncEnabled ? 'âœ… Yes' : 'âŒ No').withId('account-sync-status');\n              });\n            });\n\n            a.separator();\n\n            a.hbox(() => {\n              a.button('âœ… Connect Account')\n                .withId('btn-connect')\n                .onClick(async () => {\n                  const result = await win.showForm('Connect to NextCloud', [\n                    { type: 'entry', label: 'Server URL', key: 'server' },\n                    { type: 'entry', label: 'Username', key: 'username' },\n                    { type: 'password', label: 'Password', key: 'password' },\n                  ]);\n\n                  if (result.submitted) {\n                    store.connectAccount(\n                      result.values.server,\n                      result.values.username,\n                      result.values.password\n                    );\n                  }\n                });\n\n              a.button('âŒ Disconnect')\n                .withId('btn-disconnect')\n                .onClick(() => {\n                  store.disconnectAccount();\n                });\n\n              a.spacer();\n\n              a.button(account.syncEnabled ? 'Disable Sync' : 'Enable Sync')\n                .withId('btn-toggle-sync')\n                .onClick(() => {\n                  store.toggleSync(!account.syncEnabled);\n                });\n            });\n          }).when(() => selectedTab === 'account');\n        });\n      });\n    });\n\n    // Subscribe to store changes\n    store.subscribe(async () => {\n      await updateStatusLabels();\n      await viewStack.refresh();\n    });\n\n    // Initial setup\n    (async () => {\n      await updateStatusLabels();\n    })();\n\n    win.show();\n  });\n}\n\nexport default buildNextCloudApp;\n"]}